var We=Object.defineProperty;var Je=(i,a,s)=>a in i?We(i,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[a]=s;var ue=(i,a,s)=>Je(i,typeof a!="symbol"?a+"":a,s);import{l as Xe,r as h,j as e,L as b,B as S,X as Ye,e as ve,u as ye,aG as Re,I as se,ac as O,S as X,t as Y,v as Z,w as ee,x as v,a as Ve,D as re,q as ae,F as te,G as ne,aK as ie,aH as ze,s as _,aI as He,aJ as R,cf as Ze,cg as es,f as ss,C as xe,W as pe,Y as je,$ as ge,A as fe,i as be,aL as we,V as Ce}from"./index-NZ6jJLfQ.js";import{T as Oe,a as Ue,b as G,c as K}from"./tabs-BdaywI_b.js";import{F as Be,a as F,b as q,c as D,d as k,f as P,e as H}from"./form-DwbSQQJ0.js";import{C as rs}from"./checkbox-BsRNEGV1.js";import{C as as}from"./camera-DACJL5j2.js";import{U as ts}from"./upload-DF4rjO7T.js";import{L as Ge}from"./lightbulb-BU2ctenD.js";import{u as he}from"./useQuery-kdg2pmgf.js";import{u as B}from"./useMutation-DluhVBs1.js";import{B as me}from"./badge-vNTKF5RD.js";import{T as Se,a as Ne,b as M,c as A,d as Ee,e as C}from"./table-DnQAmABX.js";import{A as _e,a as Fe,b as qe,c as De,d as ke,e as Te,f as Le,g as Ae}from"./alert-dialog-CtyYUxwH.js";import{E as Pe}from"./eye-BE_DouVP.js";import{E as ns}from"./external-link-QJoXZ6ES.js";import{S as Ie}from"./square-pen-BMpSgZGa.js";import{C as is}from"./circle-check-big-CilmNGCn.js";import{e as Me}from"./es-CSiFCUGj.js";import{S as os}from"./settings-egXcSQW9.js";import"./vite-preload-helper-ckwbz45p.js";import"./commonjs-helpers-Cpj98o6Y.js";import"./index-hC3MxXep.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=Xe("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);function ls({onScreenshotCapture:i,onClear:a,currentScreenshot:s}){const[c,t]=h.useState(s||null),[d,y]=h.useState(null),j=h.useRef(null);h.useEffect(()=>{t(s||null)},[s]),h.useEffect(()=>{if(!c){y(null);return}let x=!1;const l=new Image;return l.onload=()=>{if(x)return;const w=l.naturalWidth||0,p=l.naturalHeight||0;y(w>0&&p>0?{width:w,height:p}:null)},l.onerror=()=>{x||y(null)},l.src=c,()=>{x=!0}},[c]);const g=x=>{var p;const l=(p=x.target.files)==null?void 0:p[0];if(!l)return;if(!l.type.startsWith("image/")){alert("Por favor, selecciona un archivo de imagen v√°lido.");return}if(l.size>5*1024*1024){alert("La imagen es demasiado grande. El tama√±o m√°ximo es 5MB.");return}const w=new FileReader;w.onload=E=>{var f;const o=(f=E.target)==null?void 0:f.result;t(o),i(o,l.name)},w.readAsDataURL(l)},N=async()=>{var l,w;let x=null;try{if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia){x=await navigator.mediaDevices.getDisplayMedia({video:{mediaSource:"screen"}});const p=document.createElement("video");p.srcObject=x,p.play(),await new Promise(f=>{p.onloadedmetadata=f});const E=document.createElement("canvas");E.width=p.videoWidth,E.height=p.videoHeight;const o=E.getContext("2d");if(o){o.drawImage(p,0,0);const f=E.toDataURL("image/png");t(f),i(f,"screenshot.png")}}else(l=j.current)==null||l.click()}catch{(w=j.current)==null||w.click()}finally{x==null||x.getTracks().forEach(p=>p.stop())}},T=()=>{t(null),j.current&&(j.current.value=""),a==null||a()};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{children:"Captura de pantalla (opcional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{type:"button",variant:"outline",onClick:N,className:"flex-1",children:[e.jsx(as,{className:"mr-2 h-4 w-4"}),"Capturar pantalla"]}),e.jsxs(S,{type:"button",variant:"outline",onClick:()=>{var x;return(x=j.current)==null?void 0:x.click()},className:"flex-1",children:[e.jsx(ts,{className:"mr-2 h-4 w-4"}),"Subir archivo"]})]}),e.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:g,className:"hidden"}),c&&e.jsxs("div",{className:"relative border rounded-lg p-2",children:[e.jsx(S,{type:"button",variant:"ghost",size:"icon",onClick:T,className:"absolute top-2 right-2 z-10",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx("img",{src:c,alt:"Screenshot preview",width:d==null?void 0:d.width,height:d==null?void 0:d.height,loading:"lazy",decoding:"async",className:"w-full h-auto rounded-md"})]})]})}const cs=100,ds=[/password/i,/token/i,/api[_-]?key/i,/secret/i,/authorization/i,/bearer/i];class us{constructor(){ue(this,"logs",[]);ue(this,"originalConsole");this.originalConsole={log:(()=>{}).bind(console),info:(()=>{}).bind(console),warn:(()=>{}).bind(console),error:(()=>{}).bind(console),debug:(()=>{}).bind(console)},this.interceptConsole()}interceptConsole(){const a=this;console.log=function(...s){a.captureLog("log",s),a.originalConsole.log(...s)},console.info=function(...s){a.captureLog("info",s),a.originalConsole.info(...s)},console.warn=function(...s){a.captureLog("warn",s),a.originalConsole.warn(...s)},console.error=function(...s){a.captureLog("error",s),a.originalConsole.error(...s)},console.debug=function(...s){a.captureLog("debug",s),a.originalConsole.debug(...s)}}captureLog(a,s){try{const c=s.map(d=>{if(typeof d=="string")return d;if(d instanceof Error)return`${d.name}: ${d.message}
${d.stack}`;try{return JSON.stringify(d)}catch{return String(d)}}).join(" ");if(this.containsSensitiveData(c))return;const t={type:a,message:c.substring(0,500),timestamp:new Date().toISOString()};this.logs.push(t),this.logs.length>cs&&this.logs.shift()}catch(c){this.originalConsole.error("Console capture error:",c)}}containsSensitiveData(a){return ds.some(s=>s.test(a))}getLogs(){return[...this.logs]}getRecentLogs(a=50){return this.logs.slice(-a)}clearLogs(){this.logs=[]}restore(){console.log=this.originalConsole.log,console.info=this.originalConsole.info,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug}}let $=null;function hs(){return $||($=new us),$}function ms(i=50){return $?$.getRecentLogs(i):[]}const xs=He({title:R().min(5,"El t√≠tulo debe tener al menos 5 caracteres"),description:R().min(10,"La descripci√≥n debe tener al menos 10 caracteres"),reproductionSteps:R().optional(),severity:es(["low","medium","high","critical"]),includeConsoleLogs:Ze().default(!1),reporterEmail:R().email("Correo electr√≥nico inv√°lido")});function ps(){const{toast:i}=ve(),{user:a}=ye(),[s,c]=h.useState(!1),[t,d]=h.useState(null),[y,j]=h.useState(null),[g,N]=h.useState(!1),[T,x]=h.useState(null),l=Re({resolver:ze(xs),defaultValues:{title:"",description:"",reproductionSteps:"",severity:"medium",includeConsoleLogs:!1,reporterEmail:(a==null?void 0:a.email)||""}});h.useEffect(()=>{a!=null&&a.email&&!l.getValues("reporterEmail")&&l.setValue("reporterEmail",a.email)},[a==null?void 0:a.email,l]);const w=(o,f)=>{d(o),j(f)},p=()=>{d(null),j(null)},E=async o=>{var f,L;c(!0);try{if(t){const oe=t.split(",")[1]||t,I=Math.ceil(oe.length*3/4),J=5*1024*1024;if(I>J){i({title:"Imagen demasiado grande",description:`La captura de pantalla es demasiado grande (${(I/1024/1024).toFixed(2)}MB). El tama√±o m√°ximo es 5MB. Por favor, usa una imagen m√°s peque√±a.`,variant:"destructive"}),c(!1);return}}const z="2026-01-09T10:30:18.965Z",U={browser:navigator.userAgent,os:((f=navigator.userAgentData)==null?void 0:f.platform)||navigator.platform||"unknown",screenWidth:window.screen.width,screenHeight:window.screen.height,language:navigator.language};let Q;o.includeConsoleLogs&&(Q=ms(100));const{data:V,error:W}=await _.functions.invoke("submit-bug-report",{body:{title:o.title,description:o.description,reproductionSteps:o.reproductionSteps,severity:o.severity,screenshot:t,screenshotFilename:y,consoleLogs:Q,reporterEmail:o.reporterEmail,appVersion:z,environmentInfo:U}});if(W)throw W;x(((L=V==null?void 0:V.githubIssue)==null?void 0:L.url)||null),N(!0);const u=l.getValues("reporterEmail");l.reset({title:"",description:"",reproductionSteps:"",severity:"medium",includeConsoleLogs:!1,reporterEmail:u}),d(null),j(null)}catch{i({title:"Error",description:"No se pudo enviar el informe de error. Por favor, int√©ntalo de nuevo.",variant:"destructive"})}finally{c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Be,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(E),className:"space-y-6",children:[e.jsx(F,{control:l.control,name:"title",render:({field:o})=>e.jsxs(q,{children:[e.jsx(D,{children:"T√≠tulo del error *"}),e.jsx(k,{children:e.jsx(se,{placeholder:"Ej: Error al guardar el formulario de asignaci√≥n",...o})}),e.jsx(P,{})]})}),e.jsx(F,{control:l.control,name:"description",render:({field:o})=>e.jsxs(q,{children:[e.jsx(D,{children:"Descripci√≥n *"}),e.jsx(k,{children:e.jsx(O,{placeholder:"Describe el error que encontraste...",className:"min-h-[100px]",...o})}),e.jsx(P,{})]})}),e.jsx(F,{control:l.control,name:"reproductionSteps",render:({field:o})=>e.jsxs(q,{children:[e.jsx(D,{children:"Pasos para reproducir (opcional)"}),e.jsx(k,{children:e.jsx(O,{placeholder:`1. Ir a la p√°gina de asignaciones
2. Hacer clic en 'Guardar'
3. Ver el error...`,className:"min-h-[80px]",...o})}),e.jsx(H,{children:"Ay√∫danos a reproducir el error listando los pasos"}),e.jsx(P,{})]})}),e.jsx(F,{control:l.control,name:"severity",render:({field:o})=>e.jsxs(q,{children:[e.jsx(D,{children:"Severidad *"}),e.jsxs(X,{onValueChange:o.onChange,defaultValue:o.value,children:[e.jsx(k,{children:e.jsx(Y,{children:e.jsx(Z,{placeholder:"Selecciona la severidad"})})}),e.jsxs(ee,{children:[e.jsx(v,{value:"low",children:"üü¢ Baja - Problema menor"}),e.jsx(v,{value:"medium",children:"üü° Media - Afecta funcionalidad"}),e.jsx(v,{value:"high",children:"üü† Alta - Problema importante"}),e.jsx(v,{value:"critical",children:"üî¥ Cr√≠tica - Bloquea trabajo"})]})]}),e.jsx(P,{})]})}),e.jsx(ls,{onScreenshotCapture:w,onClear:p,currentScreenshot:t||void 0}),e.jsx(F,{control:l.control,name:"includeConsoleLogs",render:({field:o})=>e.jsxs(q,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(k,{children:e.jsx(rs,{checked:o.value,onCheckedChange:f=>o.onChange(f===!0)})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(D,{children:"Incluir registro de consola"}),e.jsx(H,{children:"Esto puede incluir informaci√≥n t√©cnica de tu dispositivo y de la aplicaci√≥n. Los √∫ltimos 100 mensajes de consola ser√°n incluidos. Por favor, revisa que no contenga informaci√≥n sensible antes de enviar."})]})]})}),e.jsx(F,{control:l.control,name:"reporterEmail",render:({field:o})=>e.jsxs(q,{children:[e.jsx(D,{children:"Correo electr√≥nico para notificaciones *"}),e.jsx(k,{children:e.jsx(se,{type:"email",placeholder:"tu@email.com",...o})}),e.jsx(H,{children:"Te notificaremos cuando el error sea resuelto"}),e.jsx(P,{})]})}),e.jsx(S,{type:"submit",disabled:s,className:"w-full",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"Enviar informe de error"]})})]})}),e.jsx(re,{open:g,onOpenChange:N,children:e.jsx(ae,{children:e.jsxs(te,{children:[e.jsx(ne,{children:"‚úÖ Informe enviado correctamente"}),e.jsxs(ie,{className:"space-y-4 pt-4",children:[e.jsx("p",{children:"Tu informe se ha enviado correctamente. Nuestro equipo lo revisar√° y trabajar√° en resolverlo lo antes posible."}),T&&e.jsxs("p",{children:["Puedes seguir el progreso en GitHub:"," ",e.jsx("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Ver issue"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Te notificaremos por correo cuando el error sea resuelto."})]})]})})})]})}const js=He({title:R().min(5,"El t√≠tulo debe tener al menos 5 caracteres"),description:R().min(10,"La descripci√≥n debe tener al menos 10 caracteres"),useCase:R().optional(),reporterEmail:R().email("Correo electr√≥nico inv√°lido")});function gs(){const{toast:i}=ve(),{user:a}=ye(),[s,c]=h.useState(!1),[t,d]=h.useState(!1),y=Re({resolver:ze(js),defaultValues:{title:"",description:"",useCase:"",reporterEmail:(a==null?void 0:a.email)||""}}),j=async g=>{c(!0);try{const{data:N,error:T}=await _.functions.invoke("submit-feature-request",{body:{title:g.title,description:g.description,useCase:g.useCase,reporterEmail:g.reporterEmail}});if(T)throw T;d(!0),y.reset()}catch{i({title:"Error",description:"No se pudo enviar la solicitud de funci√≥n. Por favor, int√©ntalo de nuevo.",variant:"destructive"})}finally{c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Be,{...y,children:e.jsxs("form",{onSubmit:y.handleSubmit(j),className:"space-y-6",children:[e.jsx(F,{control:y.control,name:"title",render:({field:g})=>e.jsxs(q,{children:[e.jsx(D,{children:"T√≠tulo de la funci√≥n *"}),e.jsx(k,{children:e.jsx(se,{placeholder:"Ej: Exportar informes a PDF",...g})}),e.jsx(P,{})]})}),e.jsx(F,{control:y.control,name:"description",render:({field:g})=>e.jsxs(q,{children:[e.jsx(D,{children:"Descripci√≥n *"}),e.jsx(k,{children:e.jsx(O,{placeholder:"Describe la funci√≥n que te gustar√≠a tener...",className:"min-h-[120px]",...g})}),e.jsx(H,{children:"Explica qu√© te gustar√≠a que hiciera esta nueva funci√≥n"}),e.jsx(P,{})]})}),e.jsx(F,{control:y.control,name:"useCase",render:({field:g})=>e.jsxs(q,{children:[e.jsx(D,{children:"Caso de uso / Por qu√© lo necesitas (opcional)"}),e.jsx(k,{children:e.jsx(O,{placeholder:"Ej: Necesito poder exportar los informes mensuales en PDF para enviarlos a clientes...",className:"min-h-[80px]",...g})}),e.jsx(H,{children:"Ay√∫danos a entender c√≥mo usar√≠as esta funci√≥n"}),e.jsx(P,{})]})}),e.jsx(F,{control:y.control,name:"reporterEmail",render:({field:g})=>e.jsxs(q,{children:[e.jsx(D,{children:"Correo electr√≥nico para notificaciones *"}),e.jsx(k,{children:e.jsx(se,{type:"email",placeholder:"tu@email.com",...g})}),e.jsx(H,{children:"Te notificaremos sobre el estado de tu solicitud"}),e.jsx(P,{})]})}),e.jsx(S,{type:"submit",disabled:s,className:"w-full",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Enviar solicitud de funci√≥n"]})})]})}),e.jsx(re,{open:t,onOpenChange:d,children:e.jsx(ae,{children:e.jsxs(te,{children:[e.jsx(ne,{children:"‚úÖ Solicitud enviada correctamente"}),e.jsxs(ie,{className:"space-y-4 pt-4",children:[e.jsx("p",{children:"Tu solicitud de funci√≥n se ha enviado correctamente. Nuestro equipo la revisar√° y la evaluar√° para futuras versiones."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Te notificaremos por correo sobre cualquier actualizaci√≥n."})]})]})})})]})}const fs={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},vs={open:"bg-blue-100 text-blue-800",in_progress:"bg-purple-100 text-purple-800",resolved:"bg-green-100 text-green-800"},ys={pending:"bg-gray-100 text-gray-800",under_review:"bg-blue-100 text-blue-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",completed:"bg-emerald-100 text-emerald-800"};function bs(){const{toast:i}=ve(),a=ss(),[s,c]=h.useState(null),[t,d]=h.useState(null),[y,j]=h.useState(!1),[g,N]=h.useState(!1),[T,x]=h.useState(!1),[l,w]=h.useState(!1),[p,E]=h.useState(null),[o,f]=h.useState(null),[L,z]=h.useState(null),{data:U=[],isLoading:Q}=he({queryKey:["bug_reports"],queryFn:async()=>{const{data:r,error:n}=await _.from("bug_reports").select("id, title, severity, status, reporter_email, github_issue_url, github_issue_number, created_at, updated_at, resolved_at, resolved_by, admin_notes, description, reproduction_steps, app_version, environment_info").order("created_at",{ascending:!1});if(n)throw n;return r}}),{data:V=[],isLoading:W}=he({queryKey:["feature_requests"],queryFn:async()=>{const{data:r,error:n}=await _.from("feature_requests").select("*").order("created_at",{ascending:!1});if(n)throw n;return r}}),{data:u,isLoading:oe}=he({queryKey:["bug_report",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return null;const{data:r,error:n}=await _.from("bug_reports").select("*").eq("id",s.id).single();if(n)throw n;return r},enabled:!!(s!=null&&s.id)});h.useEffect(()=>{if(!(u!=null&&u.screenshot_url)){z(null);return}let r=!1;const n=new Image;return n.onload=()=>{if(r)return;const m=n.naturalWidth||0,de=n.naturalHeight||0;z(m>0&&de>0?{width:m,height:de}:null)},n.onerror=()=>{r||z(null)},n.src=u.screenshot_url,()=>{r=!0}},[u==null?void 0:u.screenshot_url]),h.useEffect(()=>{u&&s&&u.id===s.id&&c({...s,admin_notes:u.admin_notes})},[u==null?void 0:u.id,u==null?void 0:u.admin_notes,s==null?void 0:s.id]);const I=B({mutationFn:async({id:r,updates:n})=>{const{error:m}=await _.from("bug_reports").update(n).eq("id",r);if(m)throw m},onMutate:async({id:r,updates:n})=>{const m=s;return s&&s.id===r&&c({...s,...n}),{previousBug:m}},onError:(r,n,m)=>{m!=null&&m.previousBug&&c(m.previousBug),i({title:"Error updating bug report",description:r.message,variant:"destructive"})},onSettled:()=>{a.invalidateQueries({queryKey:["bug_reports"]})},onSuccess:()=>{i({title:"Bug report updated successfully"})}}),J=B({mutationFn:async({id:r,updates:n})=>{const{error:m}=await _.from("feature_requests").update(n).eq("id",r);if(m)throw m},onMutate:async({id:r,updates:n})=>{await a.cancelQueries({queryKey:["feature_requests"]});const m=t;return t&&t.id===r&&d({...t,...n}),{previousFeature:m}},onError:(r,n,m)=>{m!=null&&m.previousFeature&&d(m.previousFeature),i({title:"Error updating feature request",description:r.message,variant:"destructive"})},onSettled:()=>{a.invalidateQueries({queryKey:["feature_requests"]})},onSuccess:()=>{i({title:"Feature request updated successfully"})}}),le=B({mutationFn:async r=>{const{error:n}=await _.from("bug_reports").delete().eq("id",r);if(n)throw n},onSuccess:()=>{a.invalidateQueries({queryKey:["bug_reports"]}),i({title:"Bug report deleted successfully"}),j(!1)},onError:r=>{i({title:"Error deleting bug report",description:r.message,variant:"destructive"})}}),ce=B({mutationFn:async r=>{const{error:n}=await _.from("feature_requests").delete().eq("id",r);if(n)throw n},onSuccess:()=>{a.invalidateQueries({queryKey:["feature_requests"]}),i({title:"Feature request deleted successfully"}),N(!1)},onError:r=>{i({title:"Error deleting feature request",description:r.message,variant:"destructive"})}}),$e=B({mutationFn:async r=>{const{error:n}=await _.functions.invoke("send-bug-resolution-email",{body:{bugReportId:r}});if(n)throw n},onSuccess:()=>{i({title:"Resolution email sent successfully"})},onError:r=>{i({title:"Error sending email",description:r.message,variant:"destructive"})}}),Qe=async r=>{const n=r.status,m=r.resolved_at;try{await I.mutateAsync({id:r.id,updates:{status:"resolved",resolved_at:new Date().toISOString()}}),await $e.mutateAsync(r.id),j(!1)}catch{try{await I.mutateAsync({id:r.id,updates:{status:n,resolved_at:m}}),i({title:"Failed to send resolution email",description:"Bug status has been reverted. Please try again.",variant:"destructive"})}catch{i({title:"Critical error",description:"Bug marked as resolved but email failed to send. Please manually retry.",variant:"destructive"})}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(je,{children:"Panel de gesti√≥n"}),e.jsx(ge,{children:"Administra informes de errores y solicitudes de funciones"})]}),e.jsx(fe,{children:e.jsxs(Oe,{defaultValue:"bugs",className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-2",children:[e.jsxs(G,{value:"bugs",children:["Informes de errores (",U.length,")"]}),e.jsxs(G,{value:"features",children:["Solicitudes de funciones (",V.length,")"]})]}),e.jsx(K,{value:"bugs",className:"space-y-4",children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(Se,{children:[e.jsx(Ne,{children:e.jsxs(M,{children:[e.jsx(A,{children:"T√≠tulo"}),e.jsx(A,{children:"Severidad"}),e.jsx(A,{children:"Estado"}),e.jsx(A,{children:"Fecha"}),e.jsx(A,{children:"Acciones"})]})}),e.jsx(Ee,{children:Q?e.jsx(M,{children:e.jsx(C,{colSpan:5,className:"text-center",children:"Cargando..."})}):U.length===0?e.jsx(M,{children:e.jsx(C,{colSpan:5,className:"text-center",children:"No hay informes de errores"})}):U.map(r=>e.jsxs(M,{children:[e.jsx(C,{className:"font-medium",children:r.title}),e.jsx(C,{children:e.jsx(me,{className:fs[r.severity],children:r.severity})}),e.jsx(C,{children:e.jsx(me,{className:vs[r.status],children:r.status})}),e.jsx(C,{children:be(new Date(r.created_at),"PPP",{locale:Me})}),e.jsx(C,{children:e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>{c(r),j(!0)},children:e.jsx(Pe,{className:"h-4 w-4"})})})]},r.id))})]})})}),e.jsx(K,{value:"features",className:"space-y-4",children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(Se,{children:[e.jsx(Ne,{children:e.jsxs(M,{children:[e.jsx(A,{children:"T√≠tulo"}),e.jsx(A,{children:"Estado"}),e.jsx(A,{children:"Fecha"}),e.jsx(A,{children:"Acciones"})]})}),e.jsx(Ee,{children:W?e.jsx(M,{children:e.jsx(C,{colSpan:4,className:"text-center",children:"Cargando..."})}):V.length===0?e.jsx(M,{children:e.jsx(C,{colSpan:4,className:"text-center",children:"No hay solicitudes de funciones"})}):V.map(r=>e.jsxs(M,{children:[e.jsx(C,{className:"font-medium",children:r.title}),e.jsx(C,{children:e.jsx(me,{className:ys[r.status],children:r.status})}),e.jsx(C,{children:be(new Date(r.created_at),"PPP",{locale:Me})}),e.jsx(C,{children:e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>{d(r),N(!0)},children:e.jsx(Pe,{className:"h-4 w-4"})})})]},r.id))})]})})})]})})]}),e.jsx(re,{open:y,onOpenChange:j,children:e.jsxs(ae,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsx(ne,{children:s==null?void 0:s.title}),e.jsxs(ie,{children:["ID: ",s==null?void 0:s.id]})]}),s&&e.jsxs("div",{className:"space-y-6",children:[oe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cargando detalles..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Severidad"}),e.jsxs(X,{value:s.severity,onValueChange:r=>{I.mutate({id:s.id,updates:{severity:r}})},children:[e.jsx(Y,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(v,{value:"low",children:"Baja"}),e.jsx(v,{value:"medium",children:"Media"}),e.jsx(v,{value:"high",children:"Alta"}),e.jsx(v,{value:"critical",children:"Cr√≠tica"})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Estado"}),e.jsxs(X,{value:s.status,onValueChange:r=>{I.mutate({id:s.id,updates:{status:r}})},children:[e.jsx(Y,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(v,{value:"open",children:"Abierto"}),e.jsx(v,{value:"in_progress",children:"En progreso"}),e.jsx(v,{value:"resolved",children:"Resuelto"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Descripci√≥n"}),e.jsx("p",{className:"mt-2 text-sm",children:s.description})]}),s.reproduction_steps&&e.jsxs("div",{children:[e.jsx(b,{children:"Pasos para reproducir"}),e.jsx("p",{className:"mt-2 text-sm whitespace-pre-wrap",children:s.reproduction_steps})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Correo del reportero"}),e.jsx("p",{className:"mt-2 text-sm",children:s.reporter_email})]}),s.github_issue_url&&e.jsxs("div",{children:[e.jsx(b,{children:"GitHub Issue"}),e.jsxs("a",{href:s.github_issue_url,target:"_blank",rel:"noopener noreferrer",className:"mt-2 flex items-center text-sm text-blue-600 hover:underline",children:["#",s.github_issue_number," ",e.jsx(ns,{className:"ml-1 h-3 w-3"})]})]}),(u==null?void 0:u.screenshot_url)&&e.jsxs("div",{children:[e.jsx(b,{children:"Captura de pantalla"}),e.jsx("img",{src:u.screenshot_url,alt:"Screenshot",width:L==null?void 0:L.width,height:L==null?void 0:L.height,loading:"lazy",decoding:"async",className:"mt-2 rounded-md border max-w-full h-auto"})]}),(u==null?void 0:u.console_logs)&&u.console_logs.length>0&&e.jsxs("div",{children:[e.jsx(b,{children:"Registros de consola"}),e.jsx("div",{className:"mt-2 rounded-md bg-gray-100 p-4 max-h-60 overflow-y-auto",children:e.jsx("pre",{className:"text-xs",children:u.console_logs.map(r=>`[${r.timestamp}] ${r.type.toUpperCase()}: ${r.message}`).join(`
`)})})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Notas del administrador"}),e.jsx(O,{value:s.admin_notes||"",onChange:r=>c({...s,admin_notes:r.target.value}),placeholder:"A√±adir notas internas...",className:"mt-2"})]})]}),e.jsxs(we,{className:"flex gap-2",children:[e.jsxs(S,{variant:"destructive",onClick:()=>{E(s.id),x(!0)},children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Eliminar"]}),e.jsxs(S,{variant:"outline",onClick:()=>{I.mutate({id:s.id,updates:{admin_notes:s.admin_notes}})},children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Guardar notas"]}),s.status!=="resolved"&&e.jsxs(S,{onClick:()=>Qe(s),children:[e.jsx(is,{className:"mr-2 h-4 w-4"}),"Marcar como resuelto"]})]})]})]})}),e.jsx(re,{open:g,onOpenChange:N,children:e.jsxs(ae,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsx(ne,{children:t==null?void 0:t.title}),e.jsxs(ie,{children:["ID: ",t==null?void 0:t.id]})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Estado"}),e.jsxs(X,{value:t.status,onValueChange:r=>{J.mutate({id:t.id,updates:{status:r}})},children:[e.jsx(Y,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(v,{value:"pending",children:"Pendiente"}),e.jsx(v,{value:"under_review",children:"En revisi√≥n"}),e.jsx(v,{value:"accepted",children:"Aceptada"}),e.jsx(v,{value:"rejected",children:"Rechazada"}),e.jsx(v,{value:"completed",children:"Completada"})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Descripci√≥n"}),e.jsx("p",{className:"mt-2 text-sm",children:t.description})]}),t.use_case&&e.jsxs("div",{children:[e.jsx(b,{children:"Caso de uso"}),e.jsx("p",{className:"mt-2 text-sm whitespace-pre-wrap",children:t.use_case})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Correo del reportero"}),e.jsx("p",{className:"mt-2 text-sm",children:t.reporter_email})]}),e.jsxs("div",{children:[e.jsx(b,{children:"Notas del administrador"}),e.jsx(O,{value:t.admin_notes||"",onChange:r=>d({...t,admin_notes:r.target.value}),placeholder:"A√±adir notas internas...",className:"mt-2"})]}),e.jsxs(we,{className:"flex gap-2",children:[e.jsxs(S,{variant:"destructive",onClick:()=>{f(t.id),w(!0)},children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Eliminar"]}),e.jsxs(S,{onClick:()=>{J.mutate({id:t.id,updates:{admin_notes:t.admin_notes}})},children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Guardar notas"]})]})]})]})}),e.jsx(_e,{open:T,onOpenChange:x,children:e.jsxs(Fe,{children:[e.jsxs(qe,{children:[e.jsx(De,{children:"¬øEst√°s seguro?"}),e.jsx(ke,{children:"Esta acci√≥n no se puede deshacer. Se eliminar√° permanentemente este reporte de error."})]}),e.jsxs(Te,{children:[e.jsx(Le,{children:"Cancelar"}),e.jsx(Ae,{onClick:()=>{p&&(le.mutate(p),x(!1),j(!1),E(null))},disabled:le.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:le.isPending?"Eliminando...":"Eliminar"})]})]})}),e.jsx(_e,{open:l,onOpenChange:w,children:e.jsxs(Fe,{children:[e.jsxs(qe,{children:[e.jsx(De,{children:"¬øEst√°s seguro?"}),e.jsx(ke,{children:"Esta acci√≥n no se puede deshacer. Se eliminar√° permanentemente esta solicitud de funci√≥n."})]}),e.jsxs(Te,{children:[e.jsx(Le,{children:"Cancelar"}),e.jsx(Ae,{onClick:()=>{o&&(ce.mutate(o),w(!1),N(!1),f(null))},disabled:ce.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:ce.isPending?"Eliminando...":"Eliminar"})]})]})})]})}function Gs(){const{userRole:i}=ye(),[a,s]=h.useState("bug"),c=i==="admin"||i==="management";return h.useEffect(()=>{const t=hs();return()=>{t.restore()}},[]),e.jsx("div",{className:"container mx-auto py-6 px-4 max-w-5xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Comentarios y soporte"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Ay√∫danos a mejorar la aplicaci√≥n reportando errores o solicitando nuevas funciones"})]}),e.jsxs(Oe,{value:a,onValueChange:s,className:"w-full",children:[e.jsxs(Ue,{className:`grid w-full ${c?"grid-cols-3":"grid-cols-2"}`,children:[e.jsxs(G,{value:"bug",className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Reportar error"]}),e.jsxs(G,{value:"feature",className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Solicitar funci√≥n"]}),c&&e.jsxs(G,{value:"admin",className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Panel de gesti√≥n"]})]}),e.jsx(K,{value:"bug",className:"space-y-4",children:e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(je,{children:"Reportar un error"}),e.jsx(ge,{children:"Cu√©ntanos sobre cualquier problema que hayas encontrado en la aplicaci√≥n"})]}),e.jsx(fe,{children:e.jsx(ps,{})})]})}),e.jsx(K,{value:"feature",className:"space-y-4",children:e.jsxs(xe,{children:[e.jsxs(pe,{children:[e.jsx(je,{children:"Solicitar una nueva funci√≥n"}),e.jsx(ge,{children:"Comparte tus ideas para mejorar la aplicaci√≥n"})]}),e.jsx(fe,{children:e.jsx(gs,{})})]})}),c&&e.jsx(K,{value:"admin",className:"space-y-4",children:e.jsx(bs,{})})]})]})})}export{Gs as default};
