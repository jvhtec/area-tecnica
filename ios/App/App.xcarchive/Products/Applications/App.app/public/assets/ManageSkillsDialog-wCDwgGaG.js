import{l as ye,j as t,D as Q,q as Z,F as J,G as ee,r as p,aS as Se,aT as ve,aU as be,aV as T,aW as L,aX as V,aY as we,aZ as te,a_ as je,a$ as Ce,Q as _e,a4 as k,s as B,C as ke,W as Pe,Y as Re,A as De,B as X,X as Ee}from"./index-NZ6jJLfQ.js";import{S as Ne}from"./SignUpForm-BqJSq2KU.js";import{B as G}from"./badge-vNTKF5RD.js";import{C as Me}from"./checkbox-BsRNEGV1.js";import{P as Ae,a as Be,b as Te}from"./popover-Dl-b1R8L.js";import{C as Ve,e as Ie,a as Ke,b as Le,c as He,d as Ue}from"./command-D3uMBT-Z.js";import{P as ze}from"./plus-C3JQqq7t.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=ye("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),xt=({open:e,onOpenChange:r})=>t.jsx(Q,{open:e,onOpenChange:r,children:t.jsxs(Z,{className:"max-w-2xl",children:[t.jsx(J,{children:t.jsx(ee,{children:"Crear Nuevo Usuario"})}),t.jsx(Ne,{onBack:()=>r(!1),preventAutoLogin:!0})]})});var re=["PageUp","PageDown"],ne=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],se={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},I="Slider",[O,Oe,Fe]=be(I),[oe]=ve(I,[Fe]),[qe,U]=oe(I),ie=p.forwardRef((e,r)=>{const{name:o,min:s=0,max:a=100,step:u=1,orientation:i="horizontal",disabled:c=!1,minStepsBetweenThumbs:m=0,defaultValue:x=[s],value:y,onValueChange:l=()=>{},onValueCommit:f=()=>{},inverted:S=!1,form:b,...v}=e,g=p.useRef(new Set),h=p.useRef(0),n=i==="horizontal"?Ye:$e,[d=[],w]=Se({prop:y,defaultProp:x,onChange:j=>{var M;(M=[...g.current][h.current])==null||M.focus(),l(j)}}),C=p.useRef(d);function _(j){const E=Ze(d,j);D(j,E)}function R(j){D(j,h.current)}function H(){const j=C.current[h.current];d[h.current]!==j&&f(d)}function D(j,E,{commit:M}={commit:!1}){const $=rt(u),z=nt(Math.round((j-s)/u)*u+s,$),K=te(z,[s,a]);w((A=[])=>{const N=Ge(A,K,E);if(tt(N,m*u)){h.current=N.indexOf(K);const W=String(N)!==String(A);return W&&M&&f(N),W?N:A}else return A})}return t.jsx(qe,{scope:e.__scopeSlider,name:o,disabled:c,min:s,max:a,valueIndexToChangeRef:h,thumbs:g.current,values:d,orientation:i,form:b,children:t.jsx(O.Provider,{scope:e.__scopeSlider,children:t.jsx(O.Slot,{scope:e.__scopeSlider,children:t.jsx(n,{"aria-disabled":c,"data-disabled":c?"":void 0,...v,ref:r,onPointerDown:T(v.onPointerDown,()=>{c||(C.current=d)}),min:s,max:a,inverted:S,onSlideStart:c?void 0:_,onSlideMove:c?void 0:R,onSlideEnd:c?void 0:H,onHomeKeyDown:()=>!c&&D(s,0,{commit:!0}),onEndKeyDown:()=>!c&&D(a,d.length-1,{commit:!0}),onStepKeyDown:({event:j,direction:E})=>{if(!c){const z=re.includes(j.key)||j.shiftKey&&ne.includes(j.key)?10:1,K=h.current,A=d[K],N=u*z*E;D(A+N,K,{commit:!0})}}})})})})});ie.displayName=I;var[ae,le]=oe(I,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Ye=p.forwardRef((e,r)=>{const{min:o,max:s,dir:a,inverted:u,onSlideStart:i,onSlideMove:c,onSlideEnd:m,onStepKeyDown:x,...y}=e,[l,f]=p.useState(null),S=V(r,n=>f(n)),b=p.useRef(void 0),v=we(a),g=v==="ltr",h=g&&!u||!g&&u;function P(n){const d=b.current||l.getBoundingClientRect(),w=[0,d.width],_=Y(w,h?[o,s]:[s,o]);return b.current=d,_(n-d.left)}return t.jsx(ae,{scope:e.__scopeSlider,startEdge:h?"left":"right",endEdge:h?"right":"left",direction:h?1:-1,size:"width",children:t.jsx(ce,{dir:v,"data-orientation":"horizontal",...y,ref:S,style:{...y.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:n=>{const d=P(n.clientX);i==null||i(d)},onSlideMove:n=>{const d=P(n.clientX);c==null||c(d)},onSlideEnd:()=>{b.current=void 0,m==null||m()},onStepKeyDown:n=>{const w=se[h?"from-left":"from-right"].includes(n.key);x==null||x({event:n,direction:w?-1:1})}})})}),$e=p.forwardRef((e,r)=>{const{min:o,max:s,inverted:a,onSlideStart:u,onSlideMove:i,onSlideEnd:c,onStepKeyDown:m,...x}=e,y=p.useRef(null),l=V(r,y),f=p.useRef(void 0),S=!a;function b(v){const g=f.current||y.current.getBoundingClientRect(),h=[0,g.height],n=Y(h,S?[s,o]:[o,s]);return f.current=g,n(v-g.top)}return t.jsx(ae,{scope:e.__scopeSlider,startEdge:S?"bottom":"top",endEdge:S?"top":"bottom",size:"height",direction:S?1:-1,children:t.jsx(ce,{"data-orientation":"vertical",...x,ref:l,style:{...x.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const g=b(v.clientY);u==null||u(g)},onSlideMove:v=>{const g=b(v.clientY);i==null||i(g)},onSlideEnd:()=>{f.current=void 0,c==null||c()},onStepKeyDown:v=>{const h=se[S?"from-bottom":"from-top"].includes(v.key);m==null||m({event:v,direction:h?-1:1})}})})}),ce=p.forwardRef((e,r)=>{const{__scopeSlider:o,onSlideStart:s,onSlideMove:a,onSlideEnd:u,onHomeKeyDown:i,onEndKeyDown:c,onStepKeyDown:m,...x}=e,y=U(I,o);return t.jsx(L.span,{...x,ref:r,onKeyDown:T(e.onKeyDown,l=>{l.key==="Home"?(i(l),l.preventDefault()):l.key==="End"?(c(l),l.preventDefault()):re.concat(ne).includes(l.key)&&(m(l),l.preventDefault())}),onPointerDown:T(e.onPointerDown,l=>{const f=l.target;f.setPointerCapture(l.pointerId),l.preventDefault(),y.thumbs.has(f)?f.focus():s(l)}),onPointerMove:T(e.onPointerMove,l=>{l.target.hasPointerCapture(l.pointerId)&&a(l)}),onPointerUp:T(e.onPointerUp,l=>{const f=l.target;f.hasPointerCapture(l.pointerId)&&(f.releasePointerCapture(l.pointerId),u(l))})})}),de="SliderTrack",ue=p.forwardRef((e,r)=>{const{__scopeSlider:o,...s}=e,a=U(de,o);return t.jsx(L.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...s,ref:r})});ue.displayName=de;var F="SliderRange",me=p.forwardRef((e,r)=>{const{__scopeSlider:o,...s}=e,a=U(F,o),u=le(F,o),i=p.useRef(null),c=V(r,i),m=a.values.length,x=a.values.map(f=>he(f,a.min,a.max)),y=m>1?Math.min(...x):0,l=100-Math.max(...x);return t.jsx(L.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...s,ref:c,style:{...e.style,[u.startEdge]:y+"%",[u.endEdge]:l+"%"}})});me.displayName=F;var q="SliderThumb",fe=p.forwardRef((e,r)=>{const o=Oe(e.__scopeSlider),[s,a]=p.useState(null),u=V(r,c=>a(c)),i=p.useMemo(()=>s?o().findIndex(c=>c.ref.current===s):-1,[o,s]);return t.jsx(We,{...e,ref:u,index:i})}),We=p.forwardRef((e,r)=>{const{__scopeSlider:o,index:s,name:a,...u}=e,i=U(q,o),c=le(q,o),[m,x]=p.useState(null),y=V(r,P=>x(P)),l=m?i.form||!!m.closest("form"):!0,f=je(m),S=i.values[s],b=S===void 0?0:he(S,i.min,i.max),v=Qe(s,i.values.length),g=f==null?void 0:f[c.size],h=g?Je(g,b,c.direction):0;return p.useEffect(()=>{if(m)return i.thumbs.add(m),()=>{i.thumbs.delete(m)}},[m,i.thumbs]),t.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${b}% + ${h}px)`},children:[t.jsx(O.ItemSlot,{scope:e.__scopeSlider,children:t.jsx(L.span,{role:"slider","aria-label":e["aria-label"]||v,"aria-valuemin":i.min,"aria-valuenow":S,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...u,ref:y,style:S===void 0?{display:"none"}:e.style,onFocus:T(e.onFocus,()=>{i.valueIndexToChangeRef.current=s})})}),l&&t.jsx(pe,{name:a??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:S},s)]})});fe.displayName=q;var Xe="RadioBubbleInput",pe=p.forwardRef(({__scopeSlider:e,value:r,...o},s)=>{const a=p.useRef(null),u=V(a,s),i=Ce(r);return p.useEffect(()=>{const c=a.current;if(!c)return;const m=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(m,"value").set;if(i!==r&&y){const l=new Event("input",{bubbles:!0});y.call(c,r),c.dispatchEvent(l)}},[i,r]),t.jsx(L.input,{style:{display:"none"},...o,ref:u,defaultValue:r})});pe.displayName=Xe;function Ge(e=[],r,o){const s=[...e];return s[o]=r,s.sort((a,u)=>a-u)}function he(e,r,o){const u=100/(o-r)*(e-r);return te(u,[0,100])}function Qe(e,r){return r>2?`Value ${e+1} of ${r}`:r===2?["Minimum","Maximum"][e]:void 0}function Ze(e,r){if(e.length===1)return 0;const o=e.map(a=>Math.abs(a-r)),s=Math.min(...o);return o.indexOf(s)}function Je(e,r,o){const s=e/2,u=Y([0,50],[0,s]);return(s-u(r)*o)*o}function et(e){return e.slice(0,-1).map((r,o)=>e[o+1]-r)}function tt(e,r){if(r>0){const o=et(e);return Math.min(...o)>=r}return!0}function Y(e,r){return o=>{if(e[0]===e[1]||r[0]===r[1])return r[0];const s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(o-e[0])}}function rt(e){return(String(e).split(".")[1]||"").length}function nt(e,r){const o=Math.pow(10,r);return Math.round(e*o)/o}var xe=ie,st=ue,ot=me,it=fe;const ge=p.forwardRef(({className:e,...r},o)=>t.jsxs(xe,{ref:o,className:_e("relative flex w-full touch-none select-none items-center",e),...r,children:[t.jsx(st,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:t.jsx(ot,{className:"absolute h-full bg-primary"})}),t.jsx(it,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ge.displayName=xe.displayName;const at=({profileId:e})=>{const[r,o]=k.useState([]),[s,a]=k.useState([]),[u,i]=k.useState(!0),[c,m]=k.useState(!1),[x,y]=k.useState(""),[l,f]=k.useState(null),S=k.useCallback(async()=>{var C;i(!0);const[n,d,w]=await Promise.all([B.from("skills").select("id,name,category").eq("active",!0).order("category").order("name"),B.from("profile_skills").select("id,skill_id,proficiency,is_primary,skills:skill_id(name,category)").eq("profile_id",e).order("is_primary",{ascending:!1}).order("proficiency",{ascending:!1}),B.from("profiles").select("department").eq("id",e).maybeSingle()]);if(n.error||o(n.data||[]),!d.error){const _=(d.data||[]).map(R=>{var H,D;return{id:R.id,skill_id:R.skill_id,name:((H=R.skills)==null?void 0:H.name)||"",category:((D=R.skills)==null?void 0:D.category)||null,proficiency:R.proficiency,is_primary:!!R.is_primary}});a(_)}w.error||f(((C=w.data)==null?void 0:C.department)??null),i(!1)},[e]);k.useEffect(()=>{S()},[S]);const b=r.filter(n=>!s.some(d=>d.skill_id===n.id)),v=k.useMemo(()=>(l||"").toLowerCase()==="sound"?b.filter(n=>(n.category||"").startsWith("sound")):b,[b,l]),g=async n=>{const{data:d,error:w}=await B.from("profile_skills").insert({profile_id:e,skill_id:n.id,proficiency:3,is_primary:!1}).select("id").maybeSingle();w||a(C=>[...C,{id:d.id,skill_id:n.id,name:n.name,category:n.category,proficiency:3,is_primary:!1}]),m(!1)},h=async(n,d)=>{const{error:w}=await B.from("profile_skills").update({proficiency:d.proficiency??n.proficiency,is_primary:d.is_primary??n.is_primary}).eq("id",n.id);w||a(C=>C.map(_=>_.id===n.id?{..._,...d}:_))},P=async n=>{const{error:d}=await B.from("profile_skills").delete().eq("id",n.id);d||a(w=>w.filter(C=>C.id!==n.id))};return t.jsxs(ke,{children:[t.jsx(Pe,{children:t.jsx(Re,{children:"Skills"})}),t.jsx(De,{children:u?t.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading skills…"}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.length===0&&t.jsx("div",{className:"text-sm text-muted-foreground",children:"No skills yet. Add some below."}),s.map(n=>t.jsxs("div",{className:"flex items-center gap-2 border rounded-md px-2 py-1",children:[t.jsx(G,{variant:n.is_primary?"default":"secondary",children:n.name}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Lvl"}),t.jsx(ge,{className:"w-24",min:0,max:5,step:1,value:[Number(n.proficiency??0)],onValueChange:([d])=>h(n,{proficiency:d})})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Me,{checked:n.is_primary,onCheckedChange:d=>h(n,{is_primary:!!d})}),t.jsx("span",{className:"text-xs",children:"Primary"})]}),t.jsx(X,{variant:"ghost",size:"icon",onClick:()=>P(n),children:t.jsx(Ee,{className:"h-4 w-4"})})]},n.id))]}),t.jsxs(Ae,{open:c,onOpenChange:m,children:[t.jsx(Be,{asChild:!0,children:t.jsxs(X,{variant:"secondary",size:"sm",className:"gap-2",children:[t.jsx(ze,{className:"h-4 w-4"})," Add skill"]})}),t.jsx(Te,{className:"p-0 w-80",align:"start",children:c&&t.jsxs(Ve,{children:[t.jsx(Ie,{placeholder:"Search skills…",value:x,onValueChange:y}),t.jsxs(Ke,{children:[t.jsx(Le,{children:"No skills."}),t.jsx(He,{heading:"Available",children:v.filter(n=>!x||n.name.toLowerCase().includes(x.toLowerCase())).map(n=>t.jsxs(Ue,{onSelect:()=>g(n),children:[t.jsx("span",{children:n.name}),n.category&&t.jsx(G,{variant:"outline",className:"ml-auto text-xs",children:n.category})]},n.id))})]})]})})]})]})})]})},gt=({profileId:e,fullName:r,open:o,onOpenChange:s})=>t.jsx(Q,{open:o,onOpenChange:s,children:t.jsxs(Z,{className:"max-w-2xl",children:[t.jsx(J,{children:t.jsxs(ee,{children:["Manage Skills",r?` — ${r}`:""]})}),e&&t.jsx(at,{profileId:e})]})});export{xt as C,gt as M,ht as U};
