import{r as s,s as i}from"./index-NZ6jJLfQ.js";import{F as U}from"./flexUuidService-C9yZjzP-.js";const E=l=>{const[d,u]=s.useState(null),[c,e]=s.useState(!0),[m,t]=s.useState(null),[p,r]=s.useState(null),n=s.useCallback(async()=>{if(!l){u(null),e(!1),t(null),r(null);return}try{e(!0),t(null);const{data:{user:o}}=await i.auth.getUser();if(!o){e(!1),t("User not authenticated"),r(!1);return}const{data:a,error:x}=await i.from("profiles").select("department").eq("id",o.id).single();if(x){e(!1),t("Could not determine user department"),r(!1);return}if(!(a!=null&&a.department)){e(!1),t("User department not set"),r(!1);return}const f=await U.getFlexUuid(l,a.department);u(f.uuid),t(f.error),r(f.uuid!==null),e(!1)}catch{t("Failed to fetch flex UUID"),u(null),r(!1),e(!1)}},[l]);return s.useEffect(()=>{n()},[n]),{flexUuid:d,isLoading:c,error:m,folderExists:p,refetch:n}};export{E as u};
