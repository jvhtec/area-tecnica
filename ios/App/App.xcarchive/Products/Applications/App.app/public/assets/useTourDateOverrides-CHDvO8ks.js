import{u as v}from"./useQuery-kdg2pmgf.js";import{e as p,f,s as o}from"./index-NZ6jJLfQ.js";import{u as n}from"./useMutation-DluhVBs1.js";const K=(t,d)=>{p();const a=f(),{data:y=[],isLoading:_}=v({queryKey:["tour-date-power-overrides",t],queryFn:async()=>{const{data:e,error:r}=await o.from("tour_date_power_overrides").select("*").eq("tour_date_id",t).order("created_at",{ascending:!0});if(r)throw r;return e},enabled:!!t&&d==="power"}),{data:g=[],isLoading:l}=v({queryKey:["tour-date-weight-overrides",t],queryFn:async()=>{const{data:e,error:r}=await o.from("tour_date_weight_overrides").select("*").eq("tour_date_id",t).order("created_at",{ascending:!0});if(r)throw r;return e},enabled:!!t&&d==="weight"}),u=n({mutationFn:async e=>{const{data:r,error:i}=await o.from("tour_date_power_overrides").insert(e).select().single();if(i)throw i;return r},onSuccess:()=>{a.invalidateQueries({queryKey:["tour-date-power-overrides",t]})}}),c=n({mutationFn:async e=>{const{data:r,error:i}=await o.from("tour_date_weight_overrides").insert(e).select().single();if(i)throw i;return r},onSuccess:()=>{a.invalidateQueries({queryKey:["tour-date-weight-overrides",t]})}}),m=n({mutationFn:async({id:e,data:r})=>{const{data:i,error:s}=await o.from("tour_date_power_overrides").update(r).eq("id",e).select().single();if(s)throw s;return i},onSuccess:()=>{a.invalidateQueries({queryKey:["tour-date-power-overrides",t]})}}),w=n({mutationFn:async({id:e,table:r})=>{const i=r==="power"?"tour_date_power_overrides":"tour_date_weight_overrides",{error:s}=await o.from(i).delete().eq("id",e);if(s)throw s;return{id:e,table:r}},onSuccess:({table:e})=>{e==="power"?a.invalidateQueries({queryKey:["tour-date-power-overrides",t]}):a.invalidateQueries({queryKey:["tour-date-weight-overrides",t]})}});return{powerOverrides:y,weightOverrides:g,isLoading:_||l,createPowerOverride:u.mutateAsync,createWeightOverride:c.mutateAsync,updatePowerOverride:m.mutateAsync,deleteOverride:w.mutateAsync,isCreatingOverride:u.isPending||c.isPending,isDeletingOverride:w.isPending}};export{K as u};
