import{u as q,r as t,j as e,B as I,L as U,I as _,a as S,b as Z,s as M,c as ie,g as K,N as ce}from"./index-NZ6jJLfQ.js";import{S as de}from"./SignUpForm-BqJSq2KU.js";import{A as z,a as A}from"./alert-BqA-5jRM.js";import{A as Q}from"./arrow-left-VpQwT4cv.js";import{M as ue}from"./mail-1T3Omkp6.js";import{L as me}from"./lock-Cr7oPkPT.js";import{C as W}from"./chevron-right-Bn7Eu0F7.js";import"./vite-preload-helper-ckwbz45p.js";import"./commonjs-helpers-Cpj98o6Y.js";import"./checkbox-BsRNEGV1.js";const xe=({onBack:u})=>{const{requestPasswordReset:o,isLoading:f}=q(),[a,v]=t.useState(""),[m,l]=t.useState(null),[y,i]=t.useState(!1),b=async x=>{if(x.preventDefault(),l(null),!a){l("Please enter your email address");return}try{await o(a),i(!0)}catch(r){l(r.message||"Failed to send password reset email. Please try again.")}};return y?e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{children:e.jsx(A,{children:"If an account with that email exists, a password reset link has been sent to your email address. Please check your inbox and follow the instructions to reset your password."})}),e.jsxs(I,{type:"button",variant:"ghost",onClick:u,className:"w-full",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Back to Login"]})]}):e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Reset Password"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Enter your email address and we'll send you a link to reset your password."})]}),m&&e.jsx(z,{variant:"destructive",children:e.jsx(A,{children:m})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"reset-email",children:"Email"}),e.jsx(_,{id:"reset-email",type:"email",value:a,onChange:x=>v(x.target.value),required:!0,className:"w-full",placeholder:"Enter your email address"})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx(I,{type:"submit",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Reset Link..."]}):"Send Reset Link"}),e.jsxs(I,{type:"button",variant:"ghost",onClick:u,children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Back to Login"]})]})]})},he=({onSuccess:u})=>{const{resetPassword:o,isLoading:f}=q(),[a,v]=t.useState({password:"",confirmPassword:""}),[m,l]=t.useState(null),[y,i]=t.useState(null),[b]=Z();t.useEffect(()=>{let r=null;const g=async()=>{let h=!1;try{const p=typeof window<"u"?window.location.href:"";if(p.includes("code="))try{await M.auth.exchangeCodeForSession(p)}catch{}const L=new URL(p),k=L.searchParams,N=new URLSearchParams(L.hash.replace(/^#/,"")),c=k.get("access_token")||N.get("access_token")||void 0,P=k.get("refresh_token")||N.get("refresh_token")||void 0;if(c&&P)try{await M.auth.setSession({access_token:c,refresh_token:P})}catch{}const{data:{session:d}}=await M.auth.getSession();if(d){h=!0,i(!0);return}const{data:{subscription:w}}=M.auth.onAuthStateChange((n,C)=>{C&&!h&&(h=!0,i(!0))});r=w,setTimeout(async()=>{if(h)return;const{data:{session:n}}=await M.auth.getSession();n?(h=!0,i(!0)):h||(i(!1),l("Invalid or expired reset link. Please request a new password reset."))},2500)}catch{i(!1),l("Invalid or expired reset link. Please request a new password reset.")}};return b.get("type")==="recovery"||window.location.href.includes("type=recovery")?g():i(!1),()=>{r&&r.unsubscribe()}},[b]);const x=async r=>{if(r.preventDefault(),l(null),!a.password||!a.confirmPassword){l("Please fill in all fields");return}if(a.password.length<6){l("Password must be at least 6 characters long");return}if(a.password!==a.confirmPassword){l("Passwords do not match");return}try{await o(a.password),u()}catch(g){l(g.message||"Failed to reset password")}};return y===null?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(S,{className:"h-8 w-8 animate-spin"})}):y===!1?e.jsx("div",{className:"space-y-4",children:e.jsx(z,{variant:"destructive",children:e.jsx(A,{children:"Invalid or expired reset link. Please request a new password reset."})})}):e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Set New Password"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Enter your new password below."})]}),m&&e.jsx(z,{variant:"destructive",children:e.jsx(A,{children:m})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"new-password",children:"New Password"}),e.jsx(_,{id:"new-password",type:"password",value:a.password,onChange:r=>v({...a,password:r.target.value}),required:!0,className:"w-full",placeholder:"Enter new password",minLength:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"confirm-password",children:"Confirm Password"}),e.jsx(_,{id:"confirm-password",type:"password",value:a.confirmPassword,onChange:r=>v({...a,confirmPassword:r.target.value}),required:!0,className:"w-full",placeholder:"Confirm new password",minLength:6})]}),e.jsx(I,{type:"submit",disabled:f,className:"w-full",children:f?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating Password..."]}):"Update Password"})]})},j={name:"Sector Pro",tagline:"Área Técnica",logo:"/lovable-uploads/ce3ff31a-4cc5-43c8-b5bb-a4056d3735e4.png",colors:{blob1:"rgba(59, 130, 246, 0.5)",blob2:"rgba(139, 92, 246, 0.4)",blob3:"rgba(6, 182, 212, 0.3)"}},ke=()=>{const{session:u,userRole:o,isLoading:f,error:a,login:v}=q(),m=ie(),[l]=Z(),[y,i]=t.useState(!1),[b,x]=t.useState(!1),r=l.get("type")==="recovery",g=t.useRef(o);t.useEffect(()=>{g.current=o},[o]);const[R,h]=t.useState(""),[p,L]=t.useState(""),[k,N]=t.useState(null),[c,P]=t.useState(!1),[d,w]=t.useState(0),[n,C]=t.useState(!1),[E,ee]=t.useState(!1),F=t.useRef(null),H=t.useRef(0),T=t.useCallback(()=>{ee(!0),setTimeout(()=>{const s=K(g.current);m(s,{replace:!0})},800)},[m]),$=async()=>{if(!R||!p)return N("Por favor, introduce tu email y contraseña"),!1;N(null),P(!0);try{return await v(R,p),!0}catch(s){const D=s instanceof Error?s.message:"Error al iniciar sesión";return N(D),!1}finally{P(!1)}},G=s=>{c||(C(!0),H.current=s-d)},O=s=>{if(!n||!F.current)return;const X=F.current.offsetWidth-56-8,J=Math.max(0,Math.min(s-H.current,X));w(J)},V=async()=>{if(!n||!F.current)return;C(!1);const B=F.current.offsetWidth-56-8,X=B*.8;d>=X?(w(B),await $()||w(0)):w(0)},se=s=>G(s.clientX),te=s=>O(s.clientX),ae=()=>V(),re=()=>{n&&(C(!1),w(0))},Y=s=>G(s.touches[0].clientX),ne=s=>O(s.touches[0].clientX),le=()=>V(),oe=async s=>{s.preventDefault(),await $()&&T()};if(t.useEffect(()=>{u&&!r&&!E&&o&&T()},[u,r,E,o,T]),u&&!r&&!E&&o){const s=K(g.current);return e.jsx(ce,{to:s,replace:!0})}return y||b||r?e.jsx("div",{className:"min-h-screen flex flex-col px-4 py-8 md:py-12 bg-slate-50",children:e.jsxs("div",{className:"container max-w-lg mx-auto flex-1 flex flex-col",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 text-slate-900",children:"Bienvenido"}),e.jsx("p",{className:"text-lg text-slate-500",children:"al Área Técnica Sector-Pro"})]}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-slate-200",children:r?e.jsx(he,{onSuccess:()=>{}}):b?e.jsx(xe,{onBack:()=>x(!1)}):e.jsx(de,{onBack:()=>i(!1)})})]})}):e.jsxs("div",{className:`min-h-screen w-full overflow-hidden relative transition-opacity duration-700 ${E?"opacity-0":"opacity-100"}`,onMouseMove:n?te:void 0,onMouseUp:n?ae:void 0,onMouseLeave:re,children:[e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx("div",{className:"absolute w-96 h-96 rounded-full blur-3xl animate-pulse",style:{background:j.colors.blob1,top:"10%",left:"20%",animation:"pulse 8s ease-in-out infinite, float1 20s ease-in-out infinite"}}),e.jsx("div",{className:"absolute w-80 h-80 rounded-full blur-3xl",style:{background:j.colors.blob2,top:"50%",right:"10%",animation:"pulse 10s ease-in-out infinite 2s, float2 25s ease-in-out infinite"}}),e.jsx("div",{className:"absolute w-72 h-72 rounded-full blur-3xl",style:{background:j.colors.blob3,bottom:"10%",left:"30%",animation:"pulse 12s ease-in-out infinite 4s, float3 22s ease-in-out infinite"}}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`
              linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px)
            `,backgroundSize:"50px 50px"}})]}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:j.logo,alt:j.name,width:794,height:100,loading:"eager",decoding:"async",fetchpriority:"high",className:"h-16 w-auto mx-auto mb-4 drop-shadow-2xl"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-1",children:"Bienvenido"}),e.jsx("p",{className:"text-slate-400 text-sm",children:j.tagline})]}),e.jsx("div",{className:"relative rounded-2xl p-6 border border-white/10",style:{background:"rgba(15, 23, 42, 0.7)",backdropFilter:"blur(20px)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255,255,255,0.1)"},children:e.jsxs("form",{onSubmit:oe,className:"space-y-5",children:[(k||a)&&e.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg px-4 py-3 text-red-200 text-sm",children:k||a}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),e.jsx("input",{type:"email",value:R,onChange:s=>h(s.target.value),className:"w-full pl-11 pr-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all",placeholder:"tu@email.com",autoComplete:"email"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500"}),e.jsx("input",{type:"password",value:p,onChange:s=>L(s.target.value),className:"w-full pl-11 pr-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all",placeholder:"••••••••",autoComplete:"current-password"})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs("div",{ref:F,className:"relative h-14 rounded-full overflow-hidden cursor-pointer select-none",style:{background:"linear-gradient(90deg, rgba(59,130,246,0.15) 0%, rgba(139,92,246,0.15) 100%)",border:"1px solid rgba(255,255,255,0.1)"},onTouchStart:Y,onTouchMove:ne,onTouchEnd:le,children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.08) 50%, transparent 100%)",backgroundSize:"200% 100%",animation:"shimmer 2s ease-in-out infinite"}}),e.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none transition-opacity",style:{background:"linear-gradient(90deg, rgba(59,130,246,0.3) 0%, rgba(139,92,246,0.4) 100%)",opacity:d>0?Math.min(d/200,.8):0}}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:[e.jsx("span",{className:"text-slate-400 text-sm font-medium tracking-wide transition-opacity",style:{opacity:c?1:Math.max(.3,1-d/150)},children:c?"Iniciando sesión...":"Desliza para acceder"}),!c&&d<20&&e.jsxs("div",{className:"absolute right-4 flex gap-0.5 opacity-40",children:[e.jsx(W,{className:"w-4 h-4 text-slate-400 animate-pulse",style:{animationDelay:"0ms"}}),e.jsx(W,{className:"w-4 h-4 text-slate-400 animate-pulse",style:{animationDelay:"150ms"}})]})]}),e.jsx("div",{className:"absolute top-1 left-1 w-12 h-12 rounded-full flex items-center justify-center touch-none",style:{transform:`translateX(${d}px) scale(${n?1.05:1})`,transition:n?"none":"transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",background:c?"linear-gradient(135deg, #94a3b8 0%, #64748b 100%)":"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",boxShadow:n?"0 8px 25px rgba(59,130,246,0.5), 0 0 0 4px rgba(59,130,246,0.2)":"0 4px 15px rgba(59,130,246,0.4)"},onMouseDown:se,onTouchStart:Y,children:c?e.jsx(S,{className:"w-5 h-5 text-white animate-spin"}):e.jsx(W,{className:"w-5 h-5 text-white transition-transform",style:{transform:`translateX(${n?2:0}px)`}})})]})}),e.jsx("button",{type:"submit",className:"sr-only",children:"Iniciar sesión"}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-slate-700"})}),e.jsx("div",{className:"relative flex justify-center text-xs",children:e.jsx("span",{className:"px-2 text-slate-500 bg-slate-900/50",children:"o continúa con"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 py-3 px-4 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700 rounded-xl text-white text-sm font-medium transition-all",onClick:()=>alert("Próximamente: Inicio de sesión con Google"),children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),e.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 py-3 px-4 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700 rounded-xl text-white text-sm font-medium transition-all",onClick:()=>alert("Próximamente: Inicio de sesión con Apple"),children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})}),"Apple"]})]}),e.jsx("div",{className:"flex items-center justify-center pt-2 text-sm",children:e.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-slate-400 hover:text-white transition-colors",children:"¿Olvidaste tu contraseña?"})})]})}),e.jsxs("div",{className:"text-center text-slate-500 text-xs mt-6 space-y-2",children:[e.jsx("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"hover:text-slate-300 transition-colors",children:"Politica de Privacidad"}),e.jsxs("p",{children:["© ",new Date().getFullYear()," ",j.name,". Todos los derechos reservados."]})]})]})}),E&&e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900 flex items-center justify-center",style:{animation:"fadeIn 0.5s ease-out forwards"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(S,{className:"w-10 h-10 text-blue-500 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"Cargando tu espacio de trabajo..."})]})}),e.jsx("style",{children:`
        @keyframes float1 {
          0%, 100% { transform: translate(0, 0) scale(1); }
          33% { transform: translate(30px, -30px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
        }
        @keyframes float2 {
          0%, 100% { transform: translate(0, 0) scale(1); }
          33% { transform: translate(-40px, 30px) scale(1.05); }
          66% { transform: translate(30px, -20px) scale(0.95); }
        }
        @keyframes float3 {
          0%, 100% { transform: translate(0, 0) scale(1); }
          33% { transform: translate(20px, 20px) scale(1.08); }
          66% { transform: translate(-30px, -30px) scale(0.92); }
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      `}),f&&e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900 flex items-center justify-center",children:e.jsx(S,{className:"w-8 h-8 text-blue-500 animate-spin"})})]})};export{ke as default};
